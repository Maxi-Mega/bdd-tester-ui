FROM bdd-tester-ui-build:v0.0.12 AS builder

ENV YARN_ENABLE_NETWORK=0

WORKDIR /app

RUN corepack enable

COPY env.d.ts postcss.config.js tailwind.config.js tsconfig.app.json tsconfig.json tsconfig.node.json vite.config.ts ./
COPY index.html .
COPY public/ public/
COPY src/ src/

ARG APP_VERSION=dev

RUN VITE_APP_VERSION=$APP_VERSION yarn run build

FROM nginxinc/nginx-unprivileged:1.29-alpine3.22-slim

WORKDIR /usr/share/nginx/html/bdd-tester/ui

COPY --from=builder /app/dist .
